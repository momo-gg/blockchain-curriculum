# 2.2 Ethereum's Growing Pains

> *"Ethereum is a victim of its own success."*
> â€” Common saying in the crypto community

---

## Why This Matters

Ethereum proved that programmable blockchains work. Perhaps too well. By 2021, the network was processing hundreds of thousands to a few million transactions per day, but this success exposed fundamental limitations: fees spiked to $100+ for simple swaps, transactions took minutes to confirm, and the network consumed as much energy as a small country.

These problems drove two responses: Ethereum's multi-year transition to Proof of Stake, and the emergence of faster alternatives like Solana. Understanding Ethereum's growing pains explains why Solana exists.

---

## ðŸŸ¢ General Understanding

### When Everyone Wants to Use Ethereum

Remember the gas model from the previous module? Users bid for limited block space:

```
Block Space target: 15 million gas (max ~30 million under EIP-1559)
Demand: 150 million gas worth of transactions waiting

Result: Auction for inclusion. Highest bidders win.
```

**What This Looks Like in Practice**

During high-demand events (NFT drops, DeFi launches, market crashes):

| Action | Normal Fee | Peak Fee |
|--------|-----------|----------|
| ETH transfer | $1-5 | $20-50 |
| Token swap | $10-30 | $100-500 |
| NFT mint | $20-50 | $200-1000 |
| Complex DeFi | $50-100 | $500-2000 |

**Real Examples**
- Yuga Labs' Otherside NFT mint (May 2022): Users paid $175M in gas fees for $300M in sales
- Crypto crashes: Users trying to sell get outbid by arbitrage bots, can't exit positions
- Small users priced out: A $100 transaction with a $50 fee doesn't make sense

> ðŸ’¡ **Key Insight**: High fees aren't a bug â€” they're the market working. But they make Ethereum unusable for small transactions and many use cases.

### The Speed Perception Problem

Here's a question that confuses many people:

**"If Visa is centralized and fast, why can Solana be fast and decentralized while Ethereum can't?"**

The answer involves understanding **what "speed" actually means**:

**Three Different Speeds**

| Metric | Definition | Ethereum | Solana | Visa |
|--------|------------|----------|--------|------|
| **Throughput** | Transactions per second | Varies | Varies | Varies |
| **Latency** | Time until included in block | Varies | Varies | Varies |
| **Finality** | Time until irreversible | Varies | Varies | Varies |

Solana slot timing and commitment definitions are in Solana docs (as of [docs.solanalabs.com/consensus/commitments](https://docs.solanalabs.com/consensus/commitments) and `solana-labs/solana` clock constants).

**What does "finality" mean for card networks?**

Card networks offer fast authorization but allow reversals under chargeback rules; settlement and reversals vary by issuer and merchant agreements. For precise timelines, consult the network and issuer documentation.

> ðŸ’¡ **Key Insight**: Blockchains trade authorization speed for finality speed. Once a blockchain transaction is final, it cannot be reversed by anyone, ever. This is a fundamentally different guarantee than Visa provides.

**Why Solana Can Be Fast AND Decentralized**

Solana makes different trade-offs than Ethereum (we'll explore in Part 3):
- Higher hardware requirements for validators
- Different consensus mechanism (Proof of History)
- Parallel transaction execution

It's not "cheating" â€” it's choosing different points on the trilemma.

### Proof of Work vs. Proof of Stake

Ethereum transitioned from Proof of Work to Proof of Stake in September 2022 ("The Merge"). Here's why:

**Proof of Work (Before)**
```
To add a block:
1. Solve computational puzzle (mining)
2. Winner gets to add block and earn rewards
3. Cheating requires outspending honest miners

Security comes from: Energy expenditure
Attack cost: Buy more hardware + electricity than everyone else
```

**Proof of Stake (After)**
```
To add a block:
1. Lock up ETH as "stake"
2. Protocol selects validators randomly (weighted by stake)
3. Validators propose and vote on blocks
4. Cheating = lose your staked ETH (slashing)

Security comes from: Economic stake at risk
Attack cost: Acquire 33-51% of staked ETH and risk heavy slashing/penalties
```

**Comparison**

| Aspect | Proof of Work | Proof of Stake |
|--------|---------------|----------------|
| Energy use | ~100 TWh/year | ~0.01-0.1 TWh/year |
| Hardware | Specialized ASICs | Consumer hardware |
| Attack cost | Rent hashpower | Buy and lose ETH |
| Barrier to entry | Cheap energy access | Capital access |
| Finality | Probabilistic | Deterministic (with slashing) |

> âš ï¸ **Common Misconception**: "Proof of Stake is less secure than Proof of Work." Neither is inherently more secure â€” they have different security models and trade-offs.

> âœ… **Check Your Understanding**
> - [ ] Why do Ethereum fees spike during high demand?
> - [ ] What's the difference between latency and finality?
> - [ ] Why might Visa's "finality" be considered slower than blockchain?
> - [ ] What's the fundamental difference between PoW and PoS security?

---

## ðŸŸ¡ PM/EM Depth

### The Scalability Trilemma Revisited

Every blockchain makes trade-offs:

```
         Decentralization
              /\
             /  \
            / âŒ \
           / Can't \
          /  have   \
         /   all 3   \
        /______________\
   Security        Scalability
```

**Ethereum's Original Choice**
- âœ… Decentralization: Low hardware requirements, many nodes
- âœ… Security: High economic security, battle-tested
- âŒ Scalability: 15 TPS, high fees during congestion

**Why Ethereum Prioritized This Way**
- Decentralization = censorship resistance (core value proposition)
- Security = billions at stake, can't compromise
- Scalability = can be addressed with Layer 2 (not base layer)

### Layer 2 Solutions

Instead of changing Ethereum, build on top of it:

**Rollups**

Bundle many transactions into one Ethereum transaction:

```
User Transactions                  Ethereum Mainnet
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tx 1: Aâ†’B   â”‚
â”‚ Tx 2: Câ†’D   â”‚    Compressed
â”‚ Tx 3: Eâ†’F   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   Single L1 tx with proof
â”‚    ...      â”‚
â”‚ Tx 1000     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Cost: 1000 tx compressed into 1
Savings: 100x cheaper per transaction
```

**Two Types of Rollups**

| Type | How It Works | Trade-offs |
|------|--------------|------------|
| **Optimistic** | Assume valid, challenge period for fraud proofs | Simpler, but 7-day withdrawal delay |
| **ZK** | Prove validity mathematically | No delay, but complex circuits |

**Major Rollups**
- Arbitrum (Optimistic): $5B+ TVL
- Optimism (Optimistic): $2B+ TVL
- zkSync (ZK): $500M+ TVL
- StarkNet (ZK): $200M+ TVL

> ðŸ“Š **Business Context**: Layer 2s reduce fees 10-100x but fragment liquidity and add complexity. Users must bridge assets, and composability across L2s is limited. It's a trade-off, not a free lunch.

### The Merge: Ethereum's Transition to PoS

On September 15, 2022, Ethereum switched from PoW to PoS â€” the largest live software migration in crypto history.

**Why It Mattered**
- 99.95% reduction in energy consumption
- ~90% reduction in new ETH issuance
- Foundation for future scaling (sharding)

**What Didn't Change**
- Transaction speed (still ~12 second blocks)
- Gas fees (still supply/demand based)
- Scalability (L2s still needed)

**Staking Economics**

To become a validator:
- Stake: 32 ETH minimum (~$60K at typical prices)
- Rewards: ~4-5% APY (varies with total stake)
- Risks: Slashing for misbehavior, lockup period

> ðŸ“Š **Business Context**: The Merge was a governance success â€” coordinating thousands of node operators, billions in value, and years of development without central authority. It demonstrates that decentralized systems can make major changes.

### What Prevents Wealthy Entities from Dominating?

In Proof of Stake, more stake = more influence. Doesn't this create plutocracy?

**Mitigating Factors**

| Mechanism | How It Helps |
|-----------|--------------|
| **Quadratic voting (some protocols)** | Diminishing returns on stake |
| **Liquid staking** | Small holders can participate |
| **Slashing risk** | Large stakes = large risk |
| **Validator caps** | Protocol limits per-validator stake |
| **Social layer** | Community can fork away from capture |

**The Honest Majority Assumption**

PoS assumes 2/3 of stake is honest. This isn't naive:
- Attackers must buy massive stake (market moves against them)
- Successful attack destroys value of their stake
- Economic incentive is to keep network healthy

> ðŸ’¡ **Key Insight**: PoS security is economic, not cryptographic. Attacking is possible but economically irrational. This is similar to how burglary is possible but prison risk deters most people.

> âœ… **Check Your Understanding**
> - [ ] What's the difference between optimistic and ZK rollups?
> - [ ] What did The Merge change about Ethereum?
> - [ ] What are the economics of running an Ethereum validator?
> - [ ] How do PoS systems prevent stake concentration?

---

## ðŸ”µ Engineer Depth

### How Proof of Stake Consensus Works

Ethereum's PoS uses "Gasper" â€” combining Casper FFG (finality) and LMD-GHOST (fork choice):

**Time Structure**
```
Epoch (32 slots = 6.4 minutes)
â”œâ”€â”€ Slot 0 (12 seconds)
â”‚   â”œâ”€â”€ 1 validator proposes block
â”‚   â””â”€â”€ Committee of validators attest
â”œâ”€â”€ Slot 1
â”‚   â”œâ”€â”€ Different proposer
â”‚   â””â”€â”€ Different committee
...
â””â”€â”€ Slot 31
    â””â”€â”€ Epoch boundary (finality checkpoint)
```

**Validator Duties**

1. **Block Proposer** (random selection, one per slot)
   - Collect transactions from mempool
   - Build block
   - Propose to network

2. **Attester** (all validators, once per epoch)
   - Vote for head of chain (LMD-GHOST)
   - Vote for finality checkpoint (Casper FFG)

**The 2/3 Rule (Byzantine Fault Tolerance)**

Finality requires 2/3 of validators to agree:

```
Total Stake: 1,000,000 ETH
Validators agreeing on checkpoint: 700,000 ETH (70%) âœ…
Checkpoint is finalized!

If only 600,000 ETH (60%) agree:
Checkpoint NOT finalized (below 2/3 threshold)
```

Why 2/3?
- With 1/3 malicious, they can't finalize conflicting checkpoints
- They could prevent finality (liveness attack) but not create double-spends (safety attack)
- BFT theorem: Can tolerate up to 1/3 Byzantine failures

### Slashing: How Cheaters Are Punished

Validators are slashed (lose stake) for provable misbehavior:

**Slashable Offenses**

| Offense | Description | Penalty |
|---------|-------------|---------|
| **Double voting** | Voting for two blocks in same slot | 1/32 of stake |
| **Surround voting** | Voting to finalize conflicting chains | 1/32 of stake |
| **Proposer slashing** | Proposing two blocks for same slot | Varies |

**Correlation Penalty**

If many validators are slashed together:
```
Penalty = (individual_penalty) Ã— (validators_slashed / total_validators) Ã— 3

If you alone are slashed: ~1 ETH
If 1/3 of validators slashed: ~16 ETH (half of stake)
```

This discourages coordinated attacks and incentivizes diverse infrastructure.

**How Slashing Is Detected**

```
Validator A broadcasts: "I vote for block X in slot 100"
Validator A also broadcasts: "I vote for block Y in slot 100"

Any node can:
1. Observe both messages
2. Combine them into a "slashing proof"
3. Submit proof to beacon chain
4. Validator A is slashed
5. Whistleblower gets reward
```

### State Bloat: The Growing Database Problem

Every Ethereum node stores:
- All blocks since genesis
- Current state (every account balance, contract storage)

**State Growth**
```
2015: ~1 GB
2020: ~100 GB
2024: ~200 GB (with pruning)
Full archive node: ~15+ TB
```

**Why This Matters**

More state =
- Longer sync times
- More expensive hardware
- Fewer people run nodes
- Less decentralization

**State Rent Proposals (Not Implemented)**

```
Current: Pay once to store forever
Proposed: Pay rent to keep state alive, or it gets evicted

Problems:
- User experience (funds could "disappear")
- Implementation complexity
- Backwards compatibility
```

**Verkle Trees (Coming)**

Replace Merkle Patricia Tries with Verkle Trees:
- ~10x smaller proofs
- Enables "stateless clients"
- Key to future scalability

### EIP-1559: Fee Market Reform

Pre-1559 (before August 2021):
```
Fee = gas_price Ã— gas_used
All fees go to miners
Users guess appropriate gas price
```

Post-1559:
```
Fee = (base_fee + priority_fee) Ã— gas_used

base_fee: Protocol-determined, burned
priority_fee: Tip to validator

Base fee adjusts algorithmically:
- Block >50% full â†’ base_fee increases
- Block <50% full â†’ base_fee decreases
```

**Why Burning?**

```
Before: More activity â†’ more fees to validators
After: More activity â†’ more ETH burned â†’ reduced supply

This creates:
1. Predictable fees (base_fee adjusts smoothly)
2. ETH as "ultrasound money" (potentially deflationary)
3. Aligned incentives (validators still get tips)
```

**MEV and Priority Fees**

Validators can reorder transactions within blocks. This creates MEV:

```
Pending transactions:
1. Bob: Buy Token X
2. Large buy order that will move price

Validator reordering:
1. Validator: Buy Token X â† Frontrun
2. Large buy order (price goes up)
3. Validator: Sell Token X â† Profit
4. Bob: Buy Token X (worse price)
```

Priority fees are essentially bribes for ordering. This leads to Flashbots, MEV auctions, and eventually â€” why Solana does things differently.

### Finality Deep Dive

**Probabilistic vs. Deterministic Finality**

| Type | How It Works | Example |
|------|--------------|---------|
| Probabilistic | Reversal gets exponentially harder | Bitcoin (6 confirmations) |
| Deterministic | Reversal requires slashing 1/3 of stake | Ethereum PoS |

**Ethereum Finality Timeline**
```
t=0: Transaction submitted
t=12s: Included in block (slot)
t=~15min: Block finalized (epoch boundary + 2)

After finalization:
- Reversal requires 1/3 of all staked ETH to be slashed
- ~$15B would be destroyed (at current stake)
```

**Why 15 Minutes?**

Finality spans 2 epochs for security:
- First epoch: Prepare checkpoint (>2/3 attestations)
- Second epoch: Finalize checkpoint (confirm prepare)

This gives time for all attestations to propagate globally.

> âœ… **Check Your Understanding**
> - [ ] Explain the 2/3 rule for BFT consensus
> - [ ] What are the slashable offenses and why those specifically?
> - [ ] How does EIP-1559's base fee mechanism work?
> - [ ] Why does Ethereum finality take ~15 minutes?
> - [ ] What is state bloat and why is it a problem?

---

## Key Takeaways

1. **High fees** are markets working, but they price out small users
2. **Speed has three dimensions**: throughput, latency, and finality
3. **Proof of Stake** replaces energy expenditure with economic stake at risk
4. **The 2/3 rule** ensures safety against 1/3 Byzantine actors
5. **Slashing** makes misbehavior economically irrational
6. **Layer 2s** scale Ethereum but add complexity and fragmentation
7. **State bloat** threatens long-term decentralization

Ethereum's growing pains pushed the ecosystem to innovate. Some focused on Layer 2 solutions to scale Ethereum itself. Others asked: can we build a faster Layer 1 from scratch?

---

## Next

Before we dive into Solana, let's understand a critical component of any blockchain ecosystem: stablecoins. These are the bridge between traditional finance and crypto, and they're essential for understanding DeFi.

â†’ [2.3 Stablecoins: Digital Dollars](./2.3-stablecoins.md)
