# 4.1 Development Environment Setup

> *"Before you can build, you need the right tools."*

---

## Why This Matters

Setting up your development environment correctly saves hours of debugging later. This module walks through everything you need to start building Solana programs, from installing Rust to deploying your first program to devnet.

---

## üü¢ General Understanding

### The Solana Development Stack

Building on Solana requires a specific set of tools:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Solana Development Stack                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                      ‚îÇ
‚îÇ   LANGUAGE          FRAMEWORK         TESTING          DEPLOYMENT   ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ   ‚îÇ  Rust   ‚îÇ ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ Anchor  ‚îÇ ‚îÄ‚îÄ‚îÄ‚ñ∫  ‚îÇ Mocha   ‚îÇ ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ Devnet  ‚îÇ  ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                                      ‚îÇ
‚îÇ   Programs are     Anchor adds       Tests run in     Deploy to     ‚îÇ
‚îÇ   written in       macros and        TypeScript/JS    test network  ‚îÇ
‚îÇ   Rust             validation                         first         ‚îÇ
‚îÇ                                                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Key Points for Stakeholders:**
- Development uses **Rust** (memory-safe, high-performance language)
- **Anchor framework** reduces development time by ~50%
- Free development on **devnet** (no real money required)
- Same tools and workflow across all team members

### Why These Specific Tools?

| Tool | Why Required | Alternative |
|------|--------------|-------------|
| **Rust** | Compiles to SBF (Solana BPF) bytecode that runs on Solana | C (rare, no framework support) |
| **Anchor** | Industry standard, 90%+ of projects use it | Native Rust (more complex) |
| **Node.js** | Testing and client development | Rust tests (less common) |

---

## üü° PM/EM Depth

### Team Setup Considerations

**Developer Onboarding Time:**
- First-time Rust developers: 1-2 days for environment
- Experienced Rust developers: 1-2 hours

**System Requirements:**
- macOS, Linux, or Windows (WSL2)
- 8GB+ RAM recommended
- ~10GB disk space for toolchain

**Version Pinning:**
Projects should pin versions in documentation:
```
Rust: 1.75+
Solana CLI: 1.18+
Anchor: 0.29+
Node.js: 18+
```

### Development Workflow Overview

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Development Workflow                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                      ‚îÇ
‚îÇ   1. WRITE CODE     2. BUILD        3. TEST         4. DEPLOY       ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
‚îÇ   ‚îÇ lib.rs  ‚îÇ ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ anchor  ‚îÇ ‚îÄ‚îÄ‚ñ∫ ‚îÇ anchor  ‚îÇ ‚îÄ‚îÄ‚ñ∫ ‚îÇ anchor  ‚îÇ     ‚îÇ
‚îÇ   ‚îÇ         ‚îÇ      ‚îÇ build   ‚îÇ     ‚îÇ test    ‚îÇ     ‚îÇ deploy  ‚îÇ     ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
‚îÇ                                                                      ‚îÇ
‚îÇ   Edit Rust        Compiles to     Runs local      Pushes to        ‚îÇ
‚îÇ   program code     .so binary      validator       devnet/mainnet   ‚îÇ
‚îÇ                                                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Build Artifacts:**
- `.so` file ‚Äî compiled program binary
- `idl.json` ‚Äî interface definition (like an API spec)
- TypeScript types ‚Äî auto-generated client types

---

## üîµ Engineer Depth

## Prerequisites

Before starting, you should:
- Be comfortable with command-line interfaces
- Have basic programming experience (any language)
- Understand Solana concepts from Parts 1-3

---

## Installing the Toolchain

### 1. Install Rust

Solana programs are written in Rust. Install it via rustup:

```bash
# Install Rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Follow the prompts, then reload your shell
source $HOME/.cargo/env

# Verify installation
rustc --version
# rustc 1.75.0 (or newer)

cargo --version
# cargo 1.75.0 (or newer)
```

**Why Rust?**
- Memory safety without garbage collection
- Zero-cost abstractions
- Excellent for systems programming
- Compiles to efficient bytecode

### 2. Install Solana CLI

```bash
# Install Solana CLI tools
sh -c "$(curl -sSfL https://release.solana.com/v1.18.0/install)"

# Add to PATH (add to ~/.bashrc or ~/.zshrc for persistence)
export PATH="$HOME/.local/share/solana/install/active_release/bin:$PATH"

# Verify installation
solana --version
# solana-cli 1.18.x
```

**Key CLI Commands**

| Command | Purpose |
|---------|---------|
| `solana config get` | Show current configuration |
| `solana config set --url devnet` | Switch to devnet |
| `solana balance` | Check wallet balance |
| `solana airdrop 2` | Get devnet SOL |
| `solana program deploy` | Deploy a program |

### 3. Install Anchor Framework

Anchor is the most popular framework for Solana development:

```bash
# Install Anchor Version Manager (avm)
cargo install --git https://github.com/coral-xyz/anchor avm --locked --force

# Install latest Anchor
avm install latest
avm use latest

# Verify installation
anchor --version
# anchor-cli 0.29.0 (or newer)
```

**Why Anchor?**
- Reduces boilerplate significantly
- Automatic account validation
- Built-in testing framework
- IDL generation for clients
- Standard patterns and macros

### 4. Install Node.js (for testing)

```bash
# Using nvm (recommended)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# Install Node.js
nvm install 18
nvm use 18

# Verify
node --version
# v18.x.x

npm --version
# 9.x.x

# Install Yarn (optional but common)
npm install -g yarn
```

---

## Configuration

### Set Up Your Wallet

```bash
# Generate a new keypair (for development only!)
solana-keygen new --outfile ~/.config/solana/devnet.json

# Set as default keypair
solana config set --keypair ~/.config/solana/devnet.json

# View your public key
solana address
# Something like: 7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU
```

> ‚ö†Ô∏è **Warning**: Never use a development keypair with real funds. Generate separate keys for mainnet.

### Configure for Devnet

```bash
# Set RPC URL to devnet
solana config set --url devnet

# Verify configuration
solana config get

# Output:
# Config File: ~/.config/solana/cli/config.yml
# RPC URL: https://api.devnet.solana.com
# WebSocket URL: wss://api.devnet.solana.com/
# Keypair Path: ~/.config/solana/devnet.json
# Commitment: confirmed
```

### Get Devnet SOL

```bash
# Airdrop 2 SOL (devnet has limits)
solana airdrop 2

# Check balance
solana balance
# 2 SOL
```

If airdrop fails (rate limits), use the faucet:
- https://faucet.solana.com/

---

## Project Structure

### Create a New Anchor Project

```bash
# Create new project
anchor init my_first_program
cd my_first_program

# Project structure:
my_first_program/
‚îú‚îÄ‚îÄ Anchor.toml          # Project configuration
‚îú‚îÄ‚îÄ Cargo.toml           # Rust workspace config
‚îú‚îÄ‚îÄ package.json         # Node.js dependencies
‚îú‚îÄ‚îÄ programs/            # Your Solana programs
‚îÇ   ‚îî‚îÄ‚îÄ my_first_program/
‚îÇ       ‚îú‚îÄ‚îÄ Cargo.toml   # Program dependencies
‚îÇ       ‚îî‚îÄ‚îÄ src/
‚îÇ           ‚îî‚îÄ‚îÄ lib.rs   # Program code
‚îú‚îÄ‚îÄ tests/               # TypeScript tests
‚îÇ   ‚îî‚îÄ‚îÄ my_first_program.ts
‚îú‚îÄ‚îÄ app/                 # Frontend (optional)
‚îî‚îÄ‚îÄ migrations/          # Deployment scripts
```

### Key Files Explained

**Anchor.toml**
```toml
[features]
seeds = false
skip-lint = false

[programs.devnet]
my_first_program = "Fg6PaFpoGXkYsidMpWTK6W2BeZ7FEfcYkg476zPFsLnS"

[registry]
url = "https://api.apr.dev"

[provider]
cluster = "devnet"
wallet = "~/.config/solana/devnet.json"

[scripts]
test = "yarn run ts-mocha -p ./tsconfig.json -t 1000000 tests/**/*.ts"
```

**programs/my_first_program/src/lib.rs**
```rust
use anchor_lang::prelude::*;

declare_id!("Fg6PaFpoGXkYsidMpWTK6W2BeZ7FEfcYkg476zPFsLnS");

#[program]
pub mod my_first_program {
    use super::*;

    pub fn initialize(ctx: Context<Initialize>) -> Result<()> {
        msg!("Greetings from: {:?}", ctx.program_id);
        Ok(())
    }
}

#[derive(Accounts)]
pub struct Initialize {}
```

---

## Build and Test Workflow

### Building Your Program

```bash
# Build the program
anchor build

# This creates:
# - target/deploy/my_first_program.so (compiled program)
# - target/idl/my_first_program.json (interface definition)
# - target/types/my_first_program.ts (TypeScript types)
```

### Running Tests

```bash
# Run all tests
anchor test

# Run tests with logs visible
anchor test -- --features "debug"

# Run specific test
anchor test -- --test-threads=1
```

### Local Validator

For faster iteration, run a local validator:

```bash
# Terminal 1: Start local validator
solana-test-validator

# Terminal 2: Configure CLI for localhost
solana config set --url localhost

# Build and deploy locally
anchor build
anchor deploy

# Run tests against local validator
anchor test --skip-local-validator
```

### Deploying to Devnet

```bash
# Ensure you're on devnet
solana config set --url devnet

# Check balance (need ~2 SOL for deployment)
solana balance

# Build and deploy
anchor build
anchor deploy

# Or in one command
anchor build && anchor deploy
```

---

## IDE Setup

### VS Code (Recommended)

Install these extensions:

| Extension | Purpose |
|-----------|---------|
| rust-analyzer | Rust language server |
| Even Better TOML | TOML file support |
| Error Lens | Inline error display |
| GitLens | Git integration |

**settings.json additions:**
```json
{
    "rust-analyzer.checkOnSave.command": "clippy",
    "rust-analyzer.cargo.features": "all",
    "[rust]": {
        "editor.formatOnSave": true
    }
}
```

### Useful Aliases

Add to your shell profile (`~/.bashrc` or `~/.zshrc`):

```bash
# Solana shortcuts
alias sb="anchor build"
alias st="anchor test"
alias sd="anchor deploy"

# Quick cluster switching
alias devnet="solana config set --url devnet"
alias mainnet="solana config set --url mainnet-beta"
alias localnet="solana config set --url localhost"

# View program logs
alias logs="solana logs"
```

---

## Troubleshooting

### Common Issues

**"Error: Account not found"**
```bash
# Usually means no SOL in wallet
solana airdrop 2
```

**"Error: custom program error: 0x1"**
```bash
# Generic error - check your program logs
solana logs --url devnet
```

**"BPF program not found"**
```bash
# Program not deployed or wrong program ID
# Check Anchor.toml has correct program ID
anchor keys list
```

**"Transaction simulation failed"**
```bash
# Often insufficient compute units
# Add to your instruction:
# .with_compute_unit_limit(400_000)
```

**Build fails with "linking with cc failed"**
```bash
# Install build essentials
# Ubuntu/Debian:
sudo apt install build-essential

# macOS:
xcode-select --install
```

### Useful Debug Commands

```bash
# View account data
solana account <address>

# View transaction details
solana confirm <signature> -v

# Decode program logs
solana logs <program-id>

# Check program deployment status
solana program show <program-id>
```

---

## Environment Summary

After setup, verify everything works:

```bash
# Check all versions
rustc --version      # 1.75+
cargo --version      # 1.75+
solana --version     # 1.18+
anchor --version     # 0.29+
node --version       # 18+

# Check configuration
solana config get    # Should show devnet

# Check balance
solana balance       # Should have SOL

# Build test project
anchor init test_setup
cd test_setup
anchor build         # Should succeed
anchor test          # Should pass
```

---

## Key Takeaways

1. **Rust is required** ‚Äî Solana programs compile to BPF bytecode
2. **Anchor simplifies development** ‚Äî use it unless you have a reason not to
3. **Devnet is for development** ‚Äî free SOL, no real value at risk
4. **Local validator is faster** ‚Äî use for rapid iteration
5. **Keep environments separate** ‚Äî different keypairs for devnet/mainnet

---

## Next

With your environment ready, let's write your first Solana program.

‚Üí [4.2 Your First Solana Program](./4.2-first-solana-program.md)
